<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <meta name="format-detection" content="telephone=no">
      <meta name="msapplication-tap-highlight" content="no">
      <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
      <link rel="stylesheet" href="css/fontawesome.css">
      <link rel="stylesheet" href="css/solid.css">
      <link rel="stylesheet" href="css/bootstrap.css">
      <link rel="stylesheet" href="css/index.css">
      <script src="cordova.js"></script>
  </head>
  <body class="bg-light">
    <!-- Barra superior -->
    <div class="sticky-top bg-primary d-flex p-2">
      <div class="col-6">
        <p class="m-2 h4"><a href="categorias.html"><i class="fa-solid fa-arrow-left"></i></a> Ejercicios</p>
      </div>
      <div class="text-end col-6">
        <button data-bs-toggle="modal" data-bs-target="#modalCEjercicio" class="btn btn-secondary me-1"><i class="fas fa-search"></i></button>
        <button data-bs-toggle="modal" data-bs-target="#modalCEjercicio" class="btn btn-primary me-1"><i class="fas fa-plus"></i></button>
      </div>
    </div>
    <!-- Fin barra superior -->
    
    <div id="ejercicios"></div>

    <!-- Modal nuevo ejercicio -->
    <div class="modal fade" id="modalCEjercicio" tabindex="-1" aria-labelledby="modalCEjercicioLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="modalCEjercicioLabel">Crear ejercicio</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="input-group mb-2">
              <input type="text" class="form-control" autofocus placeholder="Nombre del ejercicio:" name="nombre" id="nombre" />
            </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary">Guardar</button>
          </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Fin modal nuevo ejercicio -->

    <!-- Modal editar ejercicio -->
    <div class="modal fade" id="modalUEjercicio" tabindex="-1" aria-labelledby="modalUEjercicioLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="modalUEjercicioLabel"></h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="input-group mb-2">
              <input type="text" class="form-control" autofocus placeholder="Nombre de la categoría:" name="nombre" id="nombre" />
            </div>
            <div class="input-group flex-nowrap mb-2">
              <span class="input-group-text">Color</span>
              <input type="color" class="form-control form-control-color" name="color" id="color" />
            </div>
            <p class="text-center">Días de recuperación: <output id="num">2</output></p>
            <input type="range" class="form-range" min="0" max="7" id="recuperacion" name="recuperacion" oninput="num.value = this.value" value="2" />
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary">Actualizar</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Fin modal editar ejercicio -->

    <!-- Modal borrar ejercicio -->
    <div class="modal fade" id="modalDEjercicio" tabindex="-1" aria-labelledby="modalDEjercicioLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="modalDEjercicioLabel"></h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>¡Se eliminará el ejercicio!</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary">Eliminar</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Fin modal borrar ejercicio -->

    <!-- Barra inferior -->
    <div class="align-items-center mh-45px fixed-bottom bg-primary p-2 d-flex justify-content-around" w3-include-html="footer.html"></div>
    <script src="js/footer.js"></script>
    <script>includeHTML();</script>
    <!-- Fin  barra inferior -->
    
    <!-- <script src="js/index.js"></script> -->
    <script src="js/db.js"></script>
    <script src="js/bootstrap.js"></script>
    <script>
      document.addEventListener('deviceready', function() {
        const db = conexion();
        crearMetricas();
        crearTipos();
        crearCategorias();
        crearEjercicios();
        const urlParams = new URLSearchParams(window.location.search);
        const grupo_muscular = urlParams.get('grupo_muscular');
        db.transaction(function(tx) {
          tx.executeSql('SELECT * FROM EJERCICIO WHERE GRUPO_MUSCULAR = ' + grupo_muscular, [], function(tx, rs) {
            for (let i = 0; i < rs.rows.length; i++) {
                let ejercicio = rs.rows.item(i);
                const div1 = document.createElement("div");
                div1.className = "px-4 my-2";

                const div2 = document.createElement("div");
                div2.className = "bg-white rounded shadow-sm p-3 row align-items-center";

                const div3 = document.createElement("div");
                div3.className = "col-4";

                const img = document.createElement("img");
                img.className = "rounded-circle shadow img-fluid";
                img.src = ejercicio.imagen;

                const div4 = document.createElement("div");
                div4.className = "col-8";

                const div5 = document.createElement("div");
                div5.className = "row align-items-center";

                const div6 = document.createElement("div");
                div6.className = "col-12";

                const p = document.createElement("p");
                p.innerHTML = "<strong><u>" + ejercicio.nombre + "</u></strong>";

                const btn1 = document.createElement("button");
                btn1.className = "btn m-1 btn-primary";
                btn1.id = ejercicio.ID;
                const i1 = document.createElement("i");
                i1.className = "fa-solid fa-info-circle";
                btn1.appendChild(i1);

                const btn2 = document.createElement("button");
                btn2.className = "btn m-1 btn-primary";
                btn2.id = ejercicio.ID;
                const i2 = document.createElement("i");
                i2.className = "fa-solid fa-chart-line";
                btn2.appendChild(i2);

                const btn3 = document.createElement("button");
                btn3.className = "btn m-1 btn-secondary";
                btn3.id = ejercicio.ID;
                btn3.dataset.bsToggle = "modal";
                btn3.dataset.bsTarget = "#modalUEjercicio";
                btn3.dataset.bsEjercicio = ejercicio.ID;
                const i3 = document.createElement("i");
                i3.className = "fa-solid fa-pencil";
                btn3.appendChild(i3);

                const btn4 = document.createElement("button");
                btn4.className = "btn m-1 btn-secondary";
                btn4.id = ejercicio.ID;
                btn4.dataset.bsToggle = "modal";
                btn4.dataset.bsTarget = "#modalDEjercicio";
                btn4.dataset.bsEjercicio = ejercicio.ID;
                const i4 = document.createElement("i");
                i4.className = "fa-solid fa-trash-can";
                btn4.appendChild(i4);

                div6.appendChild(p);
                div6.appendChild(btn1);
                div6.appendChild(btn2);
                div6.appendChild(btn3);
                div6.appendChild(btn4);
                div5.appendChild(div6);
                div4.appendChild(div5);
                div3.appendChild(img);
                div2.appendChild(div3);
                div2.appendChild(div4);
                div1.appendChild(div2);
                document.getElementById("ejercicios").appendChild(div1);
            }
          });
        });
      }, false);
    </script>
  </body>
</html>